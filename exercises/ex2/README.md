# Exercise 2 - Create Data Model & Service with Joule

In this exercise, we will create a risk management application, helps organizations identify, assess, and track risks, while implementing mitigation strategies to minimize their impact.

## Exercise 2.1 Generate data model using Joule ‚ú®üìä

<br>__1.__ _Open_ your project
-  __Click__ on __"Guide Center"__-icon in the left-side activity bar 
-  and _select_ __"Generative AI-Powered Development"__
<br>![](/exercises/ex2/images/1_guidecenter.png)

<br>__2.__ Within the __"Generate AI-Powered Development"__ view
-  _go_ to __"Data Model and Service Creation"__ and _Click_ on __"Open Joule"__  
<br>![](/exercises/ex2/images/2_openjoule.png)

<br>__3.__ Now, Joule, the generative AI‚Äìpowered code development copilot in SAP Build Code, appears on the left panel and is ready for use.
Also, ensure that the command __/cap-gen-model__ is available; if it isn‚Äôt, type it in manually.
<br>![](/exercises/ex2/images/3_joule.png)

<br>__4.__ Next, __copy__ the below text to your Joule assistant to generate the data model and services and click on __Go__.
```
Create a risk management app with risks and mitigations. Each risk may refer to one or more mitigations. Add realistic properties to each entity, risks should include a property impact and criticality which should be an integer. Impacts should be in range of 1 to 20000 dollars. Mitigation should include a counter
```

<br>![](/exercises/ex2/images/16_addtext.png)

<br>__5.__ You will now __see__ the __generated data model__, as suggested by the Joule assistant according to your previous textual instruction.

> __‚ÑπÔ∏è NOTE__: The file generated by Joule may not be identical for every user. The data model produced can vary between participants and may also differ from the screenshots shown in the documentation.

<br>![](/exercises/ex2/images/4_jouledatamodel.png)

<br>__6.__ The data model should include a __Risks__ and __Mitigations entity__ and respective __schema-, service- and annotations-cds files__.
- __Accept__ the data model.
<br>![](/exercises/ex2/images/5_datamodel.png)

<br>__7.__ _Open_ the Project __Storyboard__
- __Click__ on __"Project Overview"__-icon in the left-side activity bar
- From your project's context actions menu __"‚ãØ"__, _select_ __Open Storyboard__ and you will see the newly generated data model and services.
<br>![](/exercises/ex2/images/6_open_storyboard.png)
<br>![](/exercises/ex2/images/7_storyboard_overview.png)

<br>__8.__ Review the generated cds-files from the project explorer
- __Click__ on __"Explorer"__-icon in the left-side activity bar
- Open and review the files from the project tree i.e ./db/schema.cds and ./srv/service.cds
<br>![](/exercises/ex2/images/8_project_explorer.png)
<br>![](/exercises/ex2/images/9_cdsfiles.png)

- __schema.cds__
```cds
namespace Risk_Management_U00;
using { cuid, managed } from '@sap/cds/common';

@assert.unique: { title: [title] }
entity Risks : cuid, managed {
  title: String(100) @mandatory;
  description: String(500);
  impact: Integer;
  criticality: Integer;
  status: String(20);
  mitigations: Association to many Mitigations on mitigations.risk = $self;
}

@assert.unique: { title: [title] }
entity Mitigations : cuid, managed {
  title: String(100) @mandatory;
  description: String(500);
  counter: Integer;
  risk: Association to Risks;
}

```

-__service.cds__
```cds
using { Risk_Management_U00 as my } from '../db/schema.cds';

@path: '/service/risk_Management_U00'
@requires: 'authenticated-user'
service risk_Management_U00Srv {
  @odata.draft.enabled
  entity Risks as projection on my.Risks;
  @odata.draft.enabled
  entity Mitigations as projection on my.Mitigations;
}
```

>In the files Schema.cds and Service.cds above, replace U00 with the unique number assigned to you.

## Exercise 2.2 Add Sample Data using Joule üóÉÔ∏è‚ú®

<br>__9.__ Go back to the __"Generate AI-Powered Development"__-view
- Go to __""Generate Sample Data"__ > __"Open Joule"__. 
- Joule panel opens with the command __/cap-gen-data__.
- Select the entity context by typing __#__ & then _clicking_ __"#db/schema.cds"__ and then enter the below prompt text. By preceding the prompt with __#-some-object-context__ you can more specifically instruct the context of the Joule generation task.

![alt text](/exercises/ex2/images/10_openjoule_datagen.png)


```
Generate sample data where impact should range from 1 to 20000
```
- Choose or type __#db/schema.cds__ and then enter the above prompt.

![alt text](/exercises/ex2/images/11_select_variable.png)

- Review the data before accepting.

<br>__10.__  __Accept__ the generated sample data, and you can see 2 csv files in the project __test__ folder.

![alt text](/exercises/ex2/images/12_accept_sampledata.png)

![alt text](/exercises/ex2/images/13_testdata_projecttree.png)  


<br>__11.__ Go back to the joule panel and click on  __"Open Data Editor"__ & review the generated sample data. 

> __‚ÑπÔ∏è NOTE__: Sample data is used to populate entities with predefined data sets for development and testing. It allows developers to quickly verify application functionality, simulate realistic scenarios, and validate service behavior. Sample data generated to the /test/data in the project folder, by default will not be copied to the SAP HANA runtime.


![alt text](/exercises/ex2/images/14_open_editor-sampledata.png)  
![alt text](/exercises/ex2/images/15_view_sampledata.png)


## Summary üìù

Joule lets you create CAP-based data entities and OData services with contextual sample data with just one text prompt. 

Continue to - [Exercise 3 - Add Application Logic](../ex3/README.md)

